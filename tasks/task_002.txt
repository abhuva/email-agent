# Task ID: 2
# Title: Implement CLI argument parsing
# Status: done
# Dependencies: 1
# Priority: high
# Description: Create a robust CLI interface with support for the required command flags and subcommands using the click library.
# Details:
Use click (not argparse) to implement CLI argument parsing as specified in the PDD. Support the following structure: `python main.py process` with flags `--uid <ID>` for targeting specific emails, `--force-reprocess` flag to overwrite existing notes, `--dry-run` flag for testing without side effects, and a separate 'cleanup-flags' subcommand (`python main.py cleanup-flags`). Include help text for each option and implement proper argument validation. For the cleanup-flags command, implement a mandatory confirmation prompt for safety as required by the PDD.

# Test Strategy:
Test each flag combination to ensure proper parsing. Verify help text is displayed correctly. Test invalid arguments to ensure appropriate error messages. Verify the confirmation prompt works correctly for the cleanup-flags command.

# Subtasks:
## 1. Set up basic CLI framework with click [done]
### Dependencies: None
### Description: Initialize the CLI framework using click and create the basic command structure
### Details:
Set up click as the CLI framework as required by the PDD. Create the main command group and set up the basic command structure with subcommands 'process' and 'cleanup-flags'. Include program name, description, and version information. Implement the basic error handling for invalid commands. Ensure the CLI structure follows exactly: `python main.py process` with flags and `python main.py cleanup-flags` as specified in the PDD.

## 2. Implement core flags and options for the process subcommand [done]
### Dependencies: 2.1
### Description: Add the primary flags and options to the process subcommand
### Details:
Implement the following options for the 'process' subcommand: '--uid <ID>' for targeting specific emails with appropriate type validation, '--force-reprocess' flag to overwrite existing notes, and '--dry-run' flag for testing without side effects. Add detailed help text for each option explaining its purpose and usage. Implement basic argument validation for each option. Ensure the implementation follows the exact structure specified in the PDD.

## 3. Implement the cleanup-flags subcommand [done]
### Dependencies: 2.1
### Description: Create the cleanup-flags subcommand with its specific options and behavior
### Details:
Add the 'cleanup-flags' subcommand to the CLI parser. Define any specific options needed for this subcommand. Implement the command structure but leave the actual confirmation prompt implementation for the next subtask. Add appropriate help text explaining the purpose and potential impact of this command. Ensure the implementation follows the exact structure specified in the PDD: `python main.py cleanup-flags`.

## 4. Implement confirmation prompt for cleanup-flags [done]
### Dependencies: 2.3
### Description: Add a mandatory confirmation prompt for the cleanup-flags command as required by the PDD
### Details:
Implement a clear and explicit confirmation prompt that warns the user about the effects of the cleanup-flags command. Use a yes/no prompt that requires explicit confirmation (e.g., 'yes' typed out fully) before proceeding. Handle user input validation and provide appropriate feedback. Ensure the command aborts if confirmation is not provided. This is a MANDATORY security requirement from the PDD.

## 5. Integrate argument parsing with main application flow [done]
### Dependencies: 2.2, 2.4
### Description: Connect the CLI parser to the main application logic
### Details:
Create a function that parses the arguments using click and returns a structured object with the parsed values. Implement comprehensive error handling for all possible input errors with clear error messages. Add input validation to ensure all required arguments are provided and have valid values. Test the CLI with various combinations of arguments to ensure correct behavior. Document the available commands and options in the help text and in a README section. Ensure all code references the settings.py facade for configuration access.

