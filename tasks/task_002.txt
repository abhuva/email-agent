# Task ID: 2
# Title: Implement flexible IMAP query system
# Status: pending
# Dependencies: 1
# Priority: high
# Description: Develop a system to use configurable IMAP queries while maintaining idempotency
# Details:
Modify the email selection logic to use the user-defined imap_query from config.yaml. Implement logic to combine this query with a NOT condition for emails already tagged with [Obsidian-Note-Created] or [Note-Creation-Failed]. This ensures the agent won't reprocess emails even with changing queries. Include proper error handling for malformed IMAP queries.

# Test Strategy:
Test with various IMAP query strings including UNSEEN, date-based queries, and complex conditions. Verify idempotency by running the same query twice and confirming no duplicate processing.
