---
description: Enforce updating Task Master after EVERY subtask and parent task completion, with a required commit before proceeding.
globs: *
alwaysApply: true
---

- **After completing ANY subtask:**
 - Update task status via Task Master (e.g., `task-master set-status --id=5.1 --status=done`).
 - Immediately stage (`git add tasks/tasks.json`) and commit (`git commit`) the updated tasks file before ANY further development, testing, or refactoring.
- **After completing ALL subtasks of a parent task:**
 - **MANDATORY:** Follow the complete task completion workflow in [task_completion_workflow.mdc](mdc:.cursor/rules/task_completion_workflow.mdc)
 - This includes: validate tests, update documentation, review for rule learnings, mark task done, and commit all changes
 - **Never skip the final stage workflow** - it ensures quality, documentation, and continuous improvement
- **Rationale:** This maintains the project as a true source of progress, prevents drift, and always enables instant context-resume for both human and AI contributors.
- **Sample workflow for subtask:**
 ```sh
 task-master set-status --id=5.1 --status=done
 git add tasks/tasks.json
 git commit -m "chore(tasks): Mark OpenRouter client subtask 5.1 complete"
 ```
- **Sample workflow for parent task (after all subtasks complete):**
 ```sh
 pytest -v                                    # Validate tests
 # Update documentation                      # Update docs
 # Review for rule learnings                # Review rules
 task-master set-status --id=5 --status=done # Mark done
 git add tasks/tasks.json
 git commit -m "chore(tasks): Mark task 5 complete"
 git add .
 git commit -m "feat(module): Task 5 - Description [docs]"
 ```
- Never continue to the next code or doc change until new status is marked and versioned in git.

- **For AI Agents Starting Work:**
 - Always read [README-AI.md](mdc:README-AI.md) first for complete project context
 - Then review [pdd.md](mdc:pdd.md) for current requirements
 - Check task status with `task-master next` or review `tasks/tasks.json`
